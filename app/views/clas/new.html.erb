<script>
    $(document).ready(function(){
        $('.i-checks').iCheck({
            checkboxClass: 'icheckbox_square-green',
            radioClass: 'iradio_square-green'
        });

        $('#classflag').change(function(){
            $.ajax({
                type:"get",
                url:"/clas/validateflag?classflag="+$('#classflag').val(),
                datatype:'json',
                success:function(data) {
                    if($('#classflag').val()=='')
                    {
                        $('.alert').html('标识不能为空！');
                        $('.alert').addClass('showerr');
                        $('.alert').removeClass('hiddenerr');
                        return false;
                    }
                    else {
                        $(data).each(
                                function (index, item) {
                                    if (item.status == 0) {
                                        $('.alert').addClass('showerr');
                                        $('.alert').removeClass('hiddenerr');
                                        $('.alert').html('标识已存在，请重新输入！');
                                        return false;
                                    }else
                                    {
                                        $('.alert').addClass('hiddenerr');
                                        $('.alert').removeClass('showerr');
                                    }
                                });
                    }
                }

            });

        });




        $('#smt').click(function(){
            var cartype='';
            if($('#C1').is(':checked')){
                cartype+='C1:';
            }
            if($('#C2').is(':checked')){
                cartype+='C2:';
            }
            if($('#C3').is(':checked')){
                cartype+='C3:';
            }
            if($('#C4').is(':checked')){
                cartype+='C4:';
            }
            if($('#A1').is(':checked')){
                cartype+='A1:';
            }
            if($('#A3').is(':checked')){
                cartype+='A3:';
            }
            if($('#B1').is(':checked')){
                cartype+='B1:';
            }
            if($('#A2').is(':checked')){
                cartype+='A2:';
            }
            if($('#B2').is(':checked')){
                cartype+='B2:';
            }
            if($('#D').is(':checked')){
                cartype+='D:';
            }
            if($('#E').is(':checked')){
                cartype+='E:';
            }
            if($('#F').is(':checked')){
                cartype+='F:';
            }
            if($('#HF').is(':checked')){
                cartype+='HF:';
            }

            if(cartype.length>0)
            {

                cartype=cartype.substring(0,cartype.length-1);
                $('#cartype').val(cartype);
            }

            if($('#subject_id').val()=='')
            {
                $('.alert').addClass('showerr');
                $('.alert').removeClass('hiddenerr');
                $('.alert').html('请选择科目');
                return false;
            }

            if($('#classflag').val()=='')
            {
                $('.alert').addClass('showerr');
                $('.alert').removeClass('hiddenerr');
                $('.alert').html('标识不能为空');
                return false;
            }

        });



        $('#subjectid').change(function(){

           $('#subject_id').val($('#subjectid').val());
        });




    });
</script>


<style type="text/css">
    .showerr{
        display: block;
    }
    .hiddenerr{
        display: none;
    }
</style>

<%= render 'layerbegin' %>



<div class="ibox-content form-horizontal m-t">
  <div class="alert alert-danger text-center hiddenerr">
    分类标识重复，请重新输入
  </div>
  <h3>新增分类</h3>



    <%= form_for(@cla,:html => {:class=>'form-horizontal m-t',:multipart => true}) do |f| %>
        <br>
        <br>


      <div class="form-group">
        <label class="col-sm-2 control-label">驾照类型：</label>
        <div class="col-sm-9">
          <div class="col-sm-12">
            <table>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="C1" value="C1" class="leixing"> <i></i> C1</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="C2" value="C2" class="leixing"> <i></i> C2</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="C3" value="C3" class="leixing"> <i></i> C3</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="C4" value="C4" class="leixing"> <i></i> C4</label>
                </div>
              </td>
            </table>
          </div>
          <div class="col-sm-12">
            <table>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="A1" value="A1" class="leixing"> <i></i> A1</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="A3" value="A3" class="leixing"> <i></i> A3</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="B1" value="B1" class="leixing"> <i></i> B1</label>
                </div>
              </td>
            </table>
          </div>

          <div class="col-sm-12">
            <table>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="A2" value="A2" class="leixing"> <i></i> A2</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="B2" value="B2" class="leixing"> <i></i> B2</label>
                </div>
              </td>
            </table>
          </div>

          <div class="col-sm-12">
            <table>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="D" value="D" class="leixing"> <i></i> D&nbsp;&nbsp;</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="E" value="E" class="leixing"> <i></i> E&nbsp;&nbsp;</label>
                </div>
              </td>
              <td>
                <div class="icheckbox i-checks">
                  <label>
                    <input type="checkbox" id="F" value="F" class="leixing"> <i></i> F</label>
                </div>
              </td>
            </table>
          </div>
          <div class="col-sm-12">

            <div class="icheckbox i-checks">
              <label>
                <input type="checkbox" id="HF" value="HF" class="leixing"> <i></i> 恢复驾考</label>
            </div>
          </div>
        </div>
      </div>


          <%= f.hidden_field :cartype ,class:"form-control",id:'cartype' %>


        <div class="form-group">
          <label class="col-sm-2 control-label">科目名称：</label>
          <div class="col-sm-9">
            <%= f.hidden_field :subject_id ,class:"form-control", id:'subject_id' %>
            <select class="form-control m-b" id="subjectid">

              <option value="0">选择科目</option>
              <% @subjects.each do |subject| %>
                  <option value=<%= subject.id %>>
                    <%= subject.subject %>
                  </option>
              <% end %>
            </select>
          </div>
        </div>

      <div class="form-group">
        <label class="col-sm-2 control-label">分类标识：</label>
        <div class="col-sm-9">
          <%= f.text_field :classflag ,class:"form-control",id:'classflag' %>
        </div>
      </div>

      <div class="form-group">
        <label class="col-sm-2 control-label">分类名称：</label>
        <div class="col-sm-9">
          <%= f.text_field :name ,class:"form-control",id:'classflag' %>
        </div>
      </div>

      <div class="form-group">
        <label class="col-sm-2 control-label">题型：</label>
        <div class="col-sm-9">
          <%= f.text_field :questiontype ,class:"form-control",id:'classflag' %>
        </div>
      </div>

        <div class="form-group">
          <label class="col-sm-2 control-label"></label>
          <div class="col-sm-9">
            <%= f.submit '确定',class: "btn btn-w-m btn-success mylink pull-right",id:'smt','data-no-turbolink'=>true %>
          </div>
        </div>




    <% end %>

</div>
<%= render 'layerend' %>